{% extends 'frc_scout/base.html' %}

{% load staticfiles %}

{% block title %}Scouting{% endblock %}
{% load compress %}

{% block extra_css %}
    {% compress css inline %}
        <style type="text/css">
            ::-webkit-input-placeholder { /* WebKit browsers */
            {#                color:    #666666 !important;#}
            {#            }#}
            {#            :-moz-placeholder { /* Mozilla Firefox 4 to 18 */#}
            {#                color:    #666666 !important;#}
            {#                opacity:  1;#}
            {#            }#}
            {#            ::-moz-placeholder { /* Mozilla Firefox 19+ */#}
            {#                color:    #666666 !important;#}
            {#                opacity:  1;#}
            {#            }#}
            {#            :-ms-input-placeholder { /* Internet Explorer 10+ */#}
            {#                color:    #666666 !important;#}
            {#            }#}

            #teleoperated {
                background: linear-gradient(rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, .3) 50%);
                padding-bottom: 10px;
            }
            #displayDot{
                height:10px;
                width:10px;
                background-color:lime;
                position:relative;
                display:none;
            }
        </style>
    {% endcompress %}
    {% compress css %}
        <link rel="stylesheet" type="text/css" href="{% static 'frc_scout/css/bootstrap-switch.min.css' %}">
    {% endcompress %}
{% endblock %}

{% block main_content %}

    <!-- ERRORS -->
    <div class="container-fluid">
        <div class="alert alert-danger alert-dismissible" role="alert" id="alert" style="margin-top: 10px; display: none;">
            <button type="button" class="close" onclick="$('#alert').hide();" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <p id="correct_errors"><strong>Please correct the following errors:</strong></p>
            <span id="alert-text"></span>
        </div>
    </div>

    <!-- LOADING SCREEN -->
    <div class="container" id="loading">
        <h1>
            Loading...
        </h1>
    </div>

    <!-- PREMATCH -->
    <div class="container-fluid stage" style="display: none;" id="prematch">
        <div class="row">
            <div class="col-md-12">
                <h2>Pre-Match<span class="team-number"></span></h2>
            </div>
        </div>
        <div class="row">
            <label for="match_number" style="padding-top:10px; font-weight: bold;" class="col-sm-4 control-label input-x-lg">Match Number:</label>
            <div class="col-sm-8">
                <input id="match_number" class="form-control input-x-lg background-white" placeholder="Match" type='number'>
            </div>
        </div>
        <br>
        <div class="row">
            <label for="team_number" style="padding-top: 10px; font-weight: bold;" class="col-sm-4 control-label input-x-lg">Team Number:</label>
            <div class="col-sm-8">
                <div id="type_team_number">
                    <input id="team_number" class="form-control input-x-lg background-white" placeholder="Team" type="number">
                </div>

                <div id="select_team_number">
                    <select id="select_team_number_select" style="padding-top: 10px;" class="form-control input-x-lg alliance-toggle background-white">
                        <option value="">Select a team</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="row" id="select_alliance_color">
            <br>
            <div class="col-md-12">
                <div class="btn-group max-width" data-toggle="buttons">
                    <label class="btn btn-lg btn-danger alliance-toggle" style="width: 50%;" id="red_alliance">
                        <input type="radio">
                        Red
                    </label>
                    <label class="btn btn-lg btn-primary alliance-toggle" style="width: 50%;" id="blue_alliance">
                        <input type="radio">
                        Blue
                    </label>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                {% if not practice_scouting %}
                    <h3 style="color: #666666;">Location: <span id='location'>{{ request.session.location_name }}</span></h3>
                {% else %}
                    <h3 style="color:#bd001f; font-weight: bold;">You are scouting a practice match. Your data will be submitted to the TEST location.</h3>
                {% endif %}
            </div>
            <br>
        </div>
        <div class="row">
            <div class="col-sm-4">
                <button class="btn btn-extra-high btn-info btn-lg max-width" onclick="window.location = '{% url 'frc_scout:index' %}';"><span class="glyphicon glyphicon-arrow-left"></span> return home</button>
            </div>
            <div class="col-sm-4">
                <button id="no_show" class="btn btn-extra-high btn-warning btn-lg max-width" onclick="changeStage('prematch',finish')">No-show</button>
            </div>
            <div class="col-sm-4">
                <button class="btn btn-extra-high btn-primary btn-lg max-width" onclick="changeStage('prematch','autonomous');">autonomous &nbsp;<span class="glyphicon glyphicon-arrow-right"></span></button>
            </div>
        </div>
        <Br>
        <div class="row">
            <div class="col-md-12">
                <button class="btn btn-extra-high btn-warning btn-lg max-width" style="display:none;" id="submit_pending" onclick="submitData();">Attempt to submit pending matches</button>
            </div>
        </div>
    </div>

    <!-- AUTONOMOUS STARTING LOCATION -->
    <div class="container-fluid stage" style="display: none;" id="autonomous_location">
        <div class="row">
            <div class="col-md-12">
                <h2>Autonomous Start<span class="team-number"></span></h2>s
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div>
                    <img src="{% static "frc_scout/img/start_zone_2016.png" %}" class="auto-location-image" id="auto_start_image">
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <button class="btn btn-lg btn-info max-width" style="margin-top: 2vh; height: 10vh;" onclick="discardAndChangeStage('autonomous_starting_location', 'prematch');"><span class="glyphicon glyphicon-arrow-left"></span>&nbsp; prematch</button>
            </div>
        </div>
    </div>

    <!-- AUTONOMOUS EVENT SELECT -->
    <div class="container-fluid stage" style="display: none;" id="autonomous">
        <div class="row">
            <div class="col-md-6">
                <h2>Autonomous<span class="team-number"></span></h2>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-6">
                <h3>Enemy Side</h3>
                <div class="row">
                    <div class="col-xs-8">
                        <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" data-name="LowGoal" selector="teleoperated_location">Made Low Goal</button>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-8">
                        <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" data-name="HighGoal" selector="teleoperated_location">Made High Goal</button>
                    </div>
                </div>
            </div>
            
            
            <div class="col-sm-6">
                <h3>Inbetween</h3>
                <div class="row">
                    <div class="col-xs-8">
                        <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" data-name="Crossing" selector="teleoperated_location">Crossed</button>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-8">
                        <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" data-name="PickupBall" selector="teleoperated_location">Picked up Ball</button>
                    </div>
                </div>
            </div>
            
            <div class="col-sm-6">
                <h3>Your Side</h3>
                <div class="row">
                    <div class="col-xs-8">
                        <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" data-name="BlockedShot" selector="teleoperated_location">Blocked a Shot</button>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-8">
                        <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" data-name="BlockedCrossing" selector="teleoperated_location">Blocked a crossing</button>
                    </div>
                </div>
            </div>
            
            <div class="col-sm-6">
                <div class="col-sm-4 col-sm-push-4">
                <!-- THE UNDO BUTTON! Javascript has not yet been implemented for this. Tell me (Drew) when Javascript exists to undo a button press  --> 
                <button id = "undo" class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract"> Undo </button>
                </div>
            </div>


            </div>
            <div class="row">
                <div class="col-sm-4 col-sm-push-4">
                    <button class="btn btn-extra-high btn-danger btn-lg max-width" onclick="saveAndContinue('autonomous', 'autonomous_fouls_and_other');">mess ups</button>
                </div>
                <div class="col-sm-4 col-sm-push-4">
                    <button class="btn btn-extra-high btn-primary btn-lg max-width" onclick="saveAndContinue('autonomous', 'teleoperated');">teleoperated  &nbsp;<span class="glyphicon glyphicon-arrow-right"></span></button>
                </div>
                <div class="col-sm-4 col-sm-pull-8">
                    <button class="btn btn-extra-high btn-info btn-lg max-width" onclick="saveAndContinue('autonomous', 'prematch');"><span class="glyphicon glyphicon-arrow-left"></span>&nbsp; Prematch</button>
                </div>
            </div>
        </div>
        <br>
    </div>

    <!-- TELEOPERATED -->
    <div class="container-fluid stage" id="teleoperated" style="display:none;">
        <div class="row">
            <div class="col-md-12">
                <h2>Teleoperated<span class="team-number"></span></h2>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-6">
                <h3>Enemy Side</h3>
                <div class="row">
                    <div class="col-xs-8">
                        <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" data-name="LowGoal" data-operation="add">Made Low Goal</button>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-8">
                        <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" data-name="HighGoal" data-operation="add">Made High Goal</button>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-8">
                        <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" data-name="Crossing" data-operation="add">Crossed</button>
                    </div>
                </div>
            </div>
            
            
            <div class="col-sm-6">
                <h3>Inbetween</h3>
                <div class="row">
                    <div class="col-xs-8">
                        <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" data-name="Crossing" data-operation="add">Crossed</button>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-8">
                        <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" data-name="PickupBall" data-operation="add">Picked up Ball</button>
                    </div>
                </div>
            </div>
            
            <div class="col-sm-6">
                <h3>Your Side</h3>
                <div class="row">
                    <div class="col-xs-8">
                        <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" data-name="BlockedShot" data-operation="add">Blocked a Shot</button>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-8">
                        <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" data-name="BlockedCrossing" data-operation="add">Blocked a crossing</button>
                    </div>
                </div>
            </div>
            
            <div class="col-sm-6">
                <div class="col-sm-4 col-sm-push-4">
                <!-- THE UNDO BUTTON! Javascript has not yet been implemented for this. Tell me (Drew) when Javascript exists to undo a button press  --> 
                <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" data-name:"Undo" data-operation="Undo"> Undo </button>
                </div>
            </div>


            </div>
        </div>
    </div>
    
    <!-- TELEOPERATED LOCATION SELECT -->
    <div class="container-fluid stage" style="display: none;" id="teleoperated_location" class="location-select">
        <div class="row">
            <div class="col-md-6">
                <h2>Teleoperated Event Location<span class="team-number"></span></h2>
            </div>
        </div>
        <div class="row">
            <div>
                <div id = "displayDot" style="height:10px;
                width:10px;
                background-color:lime;
                position:absolute;"></div>
                <img src="{% static "frc_scout/img/input_map_2016.png" %}" class="input-location-image" id="input_location_image">
                <button class="btn btn-extra-high btn-lg btn-lg-text btn-success max-width btn-add-subtract" onclick="cancelImage()"> Cancel </button>
            </div>
        </div>
        <br>
    </div>

    
    <!-- END GAME -->
    <div class="container-fluid stage" style="display: none;" id="postmatch">
        <div class="row">
            <div class="col-md-12">
                <h2>Post-Match<span class="team-number"></span></h2>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <input type="number" class="form-control background-white input-x-lg" id="match_final_score" placeholder="Final Alliance Score">
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col-md-12">
                <textarea class="form-control background-white" rows="2" id="tele_foul_context" placeholder="Please comment on any fouls that occurred during the match."></textarea>
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col-md-12">
                {#                <h5><strong>Private</strong> comments about the match. <span style="color: green; font-weight: 500;">Only your team will have access to them.</span></h5>#}
                <textarea class="form-control background-white" rows="2" id="tele_private_comments" placeholder="Private comments about the match &mdash; only your team will have access to them."></textarea>
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col-md-12">
                {#                <h5><strong>Public</strong> comments about the match. <span style="color: firebrick; font-weight: 500;">Everyone will have access to them.</span></h5>#}
                <textarea class="form-control background-white" rows="2" id="tele_public_comments" placeholder="Public comments about the match &mdash; everyone will have access to them."></textarea>
            </div>
        </div>
        <Br>
        <div class="row">
            <div class="col-sm-6">
                <button style="margin-top: 5px; margin-bottom: 5px;" class="btn btn-extra-high btn-info btn-lg max-width" onclick="saveAndContinue('postmatch', 'teleoperated');"><span class="glyphicon glyphicon-arrow-left"></span>&nbsp; teleoperated</button>
            </div>
            <div class="col-sm-6">
                <button style="margin-top: 5px; margin-bottom: 5px;" class="btn btn-extra-high btn-primary btn-lg max-width" onclick="saveAndContinue('postmatch', 'finish');">finish scouting  &nbsp;<span class="glyphicon glyphicon-arrow-right"></span></button>
            </div>
        </div>
    </div>

    <div class="container-fluid stage" id="finish" style="display: none;">
        <div class="row">
            <div class="col-md-12">
                <h2 style="margin-bottom: 15px;">Finish Scouting<span class="team-number"></span></h2>
            </div>
            <div class="row">
                <div class='col-md-12'>
                    <div class="well">
                        <div id="offline_message" style="display: none;">
                            <h4><span class="glyphicon glyphicon-exclamation-sign"></span> You are offline.</h4>
                            <h6>You may save your scouting data locally and submit it at a later time.</h6>
                            <h6>You will be redirected to restart scouting so the page will remain loaded.</h6>
                            <br>
                            <div class="row">
                                <div class="col-sm-3">
                                    <button class="btn btn-danger max-width btn-lg btn-extra-high" onclick="discardData();"><span class="glyphicon glyphicon-exclamation-sign"></span> discard data</button>
                                </div>
                                <div class="col-sm-9">
                                    <button class="btn btn-primary max-width btn-lg btn-extra-high" onclick="saveDataOffline();" id="save_data"><span class="glyphicon glyphicon-floppy-disk"></span> save offline</button>
                                </div>
                            </div>
                        </div>

                        <div id="online_message" style="display: none;">
                            <h4><span class="glyphicon glyphicon-check"></span> Ready to submit data.</h4>
                            <h6>If you have pending matches stored locally, they will also be submitted at this time.</h6>
                            <br>
                            <div class="row">
                                <div class="col-sm-3">
                                    <button class="btn btn-danger max-width btn-lg btn-extra-high" onclick="discardData();"><span class="glyphicon glyphicon-exclamation-sign"></span> discard data</button>
                                </div>
                                <div class="col-sm-9">
                                    <button class="btn btn-success max-width btn-lg btn-extra-high" onclick="submitData();" id="upload_data"><span class="glyphicon glyphicon-upload"></span> submit to database</button>
                                </div>
                            </div>
                        </div>

                        <div id="in_progress_message" style="display: none;">
                            <h4>Submitting data... <span id="in_progress_loading" style="display: none;">done.</span></h4>
                        </div>

                        <div id="finished_message" style="display: none;">
                            <h4><span class="glyphicon glyphicon-saved"></span> Your data has been <span id="submitted">submitted</span><span id="saved">saved</span><span id="deleted">deleted</span> successfully.</h4>
                            <div id="submit_errors">
                                <h6>However, the following matches were unable to be saved due to incomplete data collection:</h6>
                                <ul id="submit_errors_list">
                                </ul>
                            </div>
                            <br>
                            <div class="row">
                                <div class="col-sm-6">
                                    <button onclick="saveAndContinue('finish', 'prematch');" class="btn btn-primary max-width btn-lg btn-extra-high"><span class="glyphicon glyphicon-share-alt"></span> Scout another match</button>
                                </div>
                                <div class="col-sm-6">
                                    <button onclick="window.location = '{% url 'frc_scout:index' %}';" class="btn btn-info max-width btn-lg btn-extra-high"><span class="glyphicon glyphicon-arrow-up"></span> Return home</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <input type="hidden" id="practice_scouting" name="practice_scouting" value="{% if practice_scouting %}true{% else %}false{% endif %}">

{% endblock %}


{% block extra_js %}
        <script type="text/javascript" src="{% static 'frc_scout/js/bootstrap-switch.min.js' %}"></script>
        <script type="text/javascript" src="{% static "frc_scout/js/match-scouting.js" %}"></script>

        <script type="text/javascript">
            if($("#practice_scouting").val() === "true") {
                $("body").css({
                    "border": "10px dashed rgb(255, 52, 52)"
                });
            }
        </script>
{% endblock %}