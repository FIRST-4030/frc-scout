{% extends 'frc_scout/base.html' %}

{% load staticfiles %}

{% block title %}FRC Scout - Login{% endblock %}

{% block main_content %}
    <div class="row">
        <div class="col-md-4 col-md-offset-4" style="text-align: center;">
            <br>
            <img style="text-align: center; max-width: 300px;" src="{% static 'frc_scout/img/logo_earfuzz_hat.png' %}">
            <br>
            <h2 style="text-align: center;">FRC Scout: Login</h2>
            <form method="post">
                {% csrf_token %}

                <div class="form-group">
                    <input type="text" class="form-control" placeholder="Username or Email" name="username" required>
                    <input type="password" class="form-control" placeholder="Password" name="password" required>
                    <input type="text" id='location' class="typeahead form-control" placeholder="Loading event locations..." name="location" required="true" disabled="true">
                </div>
                <br>
                <div class="form-group">
                    <button class="btn btn-primary form-control" style="margin-bottom: 10px;">Login</button>
                    <a href="{% url 'frc_scout:create_account' %}" class="btn btn-warning form-control" type="button">Create Account</a>
                </div>
            </form>
        </div>
    </div>
{% endblock %}

{% block extra_js %}
    <script type="text/javascript">


        (function() {
            $.getJSON( '{% url 'frc_scout:get_locations' %}', {
                format: "json"
            })
                    .done(function( data ) {
                        function searcher(query, cb) {
                            var matches, substrRegex;
                            matches = [];
                            substrRegex = new RegExp(query, 'i');
                            $.each(Object.keys(data), function(i, str) {
                                if (substrRegex.test(str)) {
                                    matches.push({value: str});
                                }
                            });
                            cb(matches);
                        }

                        $("#location").prop('disabled', false);
                        $("#location").prop('placeholder', "Event Location");

                        $('.typeahead').typeahead({
                            highlight: true
                        }, {
                            name: 'events',
                            source: searcher
                        });
                    });
        })();


        $(function() { {% load staticfiles %}

        });
    </script>
{% endblock %}
